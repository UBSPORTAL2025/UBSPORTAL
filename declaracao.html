<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Declaração de Comparecimento - Caieiras</title>
    <style>
    @media print {
        @page {
            size: A4;
            margin: 0;
        }

        body {
            margin: 0;
        }

        .no-print {
            display: none;
        }

        .document {
            border: none;
            padding: 1cm;
            overflow: visible;
            box-shadow: none;
            height: 29.7cm;
            width: 21cm;
        }

        .footer {
            page-break-inside: avoid;
            margin-top: 10px;
            padding-top: 5px;
            border-top: 1px solid #ccc;
            position: absolute;
            bottom: 1cm;
            width: calc(100% - 2cm);
        }

        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 4cm;
            opacity: 0.15;
            pointer-events: none;
        }

        .value {
            border-bottom: none !important;
        }
    }

    body {
        font-family: Arial, sans-serif;
        line-height: 1.5;
        color: #333;
        max-width: 21cm;
        margin: 0 auto;
        padding: 0;
        position: relative;
        font-size: 16px;
        background-color: #f5f5f5;
    }

    .document {
        border: 1px solid #ccc;
        padding: 1cm;
        position: relative;
        background-color: #fff;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        min-height: 29.7cm;
        width: 21cm;
        box-sizing: border-box;
        margin: 0 auto;
    }

    /* Cabeçalho com as logos */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        background-color: #e8f0fe;
        border-radius: 5px;
        margin-bottom: 15px;
    }

    .header img {
        max-height: 120px;
        width: auto;
    }

    /* Container para Unidade */
    .unidade-container {
        margin-bottom: 20px;
        text-align: center;
    }

    .unidade {
        font-size: 16px;
        font-weight: bold;
        color: #194275;
    }

    .unidade p {
        margin: 0;
    }

    .title {
        font-size: 26px;
        font-weight: bold;
        text-align: center;
        margin: 25px 0;
        color: #194275;
    }

    .content {
        margin-bottom: 25px;
        text-align: justify;
        font-size: 16px;
    }

    /* Estilo para os campos */
    .info-paragraph {
        margin-bottom: 18px;
        text-align: justify;
        line-height: 1.6;
    }

    .label {
        font-weight: bold;
        color: #194275;
        margin-right: 5px;
        font-size: 18px;
    }

    .value {
        font-weight: normal;
        display: inline;
        padding: 0 5px;
        min-width: 100px;
        font-size: 18px;
        border-bottom: 1px dotted #aaa;
    }

    /* Estilo para o grupo de checkboxes */
    .service-types {
        margin: 25px 0;
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: 5px;
        text-align: center;
    }

    .service-types-title {
        font-weight: bold;
        color: #194275;
        margin-bottom: 12px;
        font-size: 18px;
    }

    .checkbox-group {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 15px;
    }

    .checkbox-item {
        display: flex;
        align-items: center;
    }

    .checkbox-item input {
        margin-right: 6px;
        transform: scale(1.4);
    }

    .checkbox-item label {
        font-size: 16px;
    }

    .signature {
        margin-top: 70px;
        border-top: 1px solid #333;
        padding-top: 5px;
        width: 50%;
        text-align: center;
        margin-left: auto;
        margin-right: auto;
        font-size: 16px;
    }

    .professional-selector {
        text-align: center;
        margin-top: 10px;
    }

    select {
        padding: 6px;
        background-color: transparent;
        border: none;
        font-size: 16px;
        color: #333;
        cursor: pointer;
        outline: none;
        text-align: center;
        width: 100%;
    }

    select.required {
        border: 1px solid #ff0000;
        background-color: #ffeeee;
    }

    .watermark {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(-30deg);
        opacity: 0.15;
        font-size: 5cm;
        color: #194275;
        z-index: 0;
        pointer-events: none;
    }

    .footer {
        margin-top: 5px;
        text-align: center;
        font-size: 14px;
        border-top: 1px solid #ccc;
        padding-top: 5px;
        color: #194275;
    }

    .footer p {
        margin: 2px 0;
    }

    .no-print {
        background-color: #f0f8ff;
        padding: 15px;
        margin-top: 20px;
        border-radius: 5px;
        border-left: 5px solid #194275;
        text-align: center;
    }

    .print-button {
        background-color: #194275;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        font-size: 16px;
        margin: 0 10px;
    }

    .print-button:hover {
        background-color: #0e2a4f;
    }

    .button-group {
        display: flex;
        justify-content: center;
        margin-top: 15px;
    }

    .reset-button {
        background-color: #6c757d;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        font-size: 16px;
    }

    .reset-button:hover {
        background-color: #5a6268;
    }

    .message {
        margin-top: 15px;
        padding: 10px;
        border-radius: 5px;
        text-align: center;
        font-weight: bold;
        display: none;
    }

    .success {
        background-color: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }
    </style>
    <link rel="icon" href="cristo.png" type="image/png">
</head>

<body>
    <div class="document">
        <!-- Cabeçalho com as logos -->
        <div class="header">
            <img src="SUS1.png" alt="Logo SUS" class="sus-logo">
            <img src="bb.png" alt="Logo UBS" class="ubs-logo">
        </div>

        <!-- Container para Unidade -->
        <div class="unidade-container">
            <div class="unidade">UBS PORTAL DAS LARANJEIRAS ANTÔNIO DE SOUZA SANTOS
                <p>CNES: 4737423</p>
            </div>
        </div>

        <div class="title">DECLARAÇÃO DE COMPARECIMENTO</div>
        <div class="content">
            Certificamos, para os devidos fins e conforme solicitado, que a pessoa abaixo identificada compareceu a esta Unidade de Saúde na data e horário previamente agendados, tendo recebido o atendimento necessário, seja como acompanhante, ou por meio de consulta ou exame, conforme a situação determinada pelo profissional responsável.
        </div>

        <!-- Informações do paciente -->
        <div class="info-paragraph">
            <span class="label">Nome:</span>
            <span class="value" id="nome" contenteditable="true"></span>
        </div>

        <div class="info-paragraph">
            <span class="label">CPF:</span>
            <span class="value" id="cpf" contenteditable="true" data-original-value=""></span>
        </div>

        <div class="info-paragraph">
            <span class="label">Data:</span>
            <span class="value" id="data" contenteditable="true"></span>
        </div>

        <div class="info-paragraph">
            <span class="label">Horário:</span>
            <span class="value" id="horario" contenteditable="true">das 00:00 às 00:00 (período da manhã)</span>
        </div>

        <!-- Tipo de atendimento -->
        <div class="service-types">
            <div class="service-types-title">Tipo de Atendimento:</div>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="consulta" name="tipo">
                    <label for="consulta">Consulta</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="exame" name="tipo">
                    <label for="exame">Exame</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="acompanhante" name="tipo">
                    <label for="acompanhante">Acompanhante</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="retorno" name="tipo">
                    <label for="retorno">Retorno</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="outro" name="tipo">
                    <label for="outro">Outro</label>
                </div>
            </div>
        </div>

        <div class="signature">
            Assinatura do Profissional
            <div class="professional-selector">
                <select id="profissional" onchange="updateProfessionalTitle()">
                    <option value="">Selecione o profissional</option>
                    <option value="Auxiliar Administrativo">Auxiliar Administrativo</option>
                    <option value="Gerente">Gerente</option>
                    <option value="Recepcionista">Recepcionista</option>
                    <option value="Médico">Médico</option>
                    <option value="Dentista">Dentista</option>
                    <option value="Psicólogo">Psicólogo</option>
                    <option value="Enfermeiro">Enfermeiro</option>
                    <option value="Técnico de Enfermagem">Técnico de Enfermagem</option>
                    <option value="Agente de Saúde">Agente de Saúde</option>
                    <option value="Assistente Social">Assistente Social</option>
                    <option value="Nutricionista">Nutricionista</option>
                    <option value="Fisioterapeuta">Fisioterapeuta</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>
        </div>

        <footer class="footer">
            <p>Caieiras, <span id="data-atual"></span></p>
            <p>Horário de emissão: <span id="hora-atual"></span></p>
            <p>www.caieiras.sp.gov.br | <span class="social-icons">@prefeituradecaieiras</span></p>
        </footer>

        <div class="watermark">UBS PORTAL</div>

        <!-- Área de botões e mensagem -->
        <div class="no-print">
            <div id="message" class="message"></div>
            <div class="button-group">
                <button class="reset-button" onclick="resetForm()">Limpar Formulário</button>
                <button class="print-button" onclick="generateAndPrint()">Imprimir Declaração</button>
            </div>
        </div>
    </div>

    <script>
    function updateDateTime() {
        const today = new Date();
        const day = String(today.getDate()).padStart(2, '0');
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const year = today.getFullYear();
        const hours = String(today.getHours()).padStart(2, '0');
        const minutes = String(today.getMinutes()).padStart(2, '0');

        document.getElementById('data-atual').textContent = `${day}/${month}/${year}`;

        // Preencher a data apenas se estiver vazia
        const dataField = document.getElementById('data');
        if (!dataField.textContent.trim()) {
            dataField.textContent = `${day}/${month}/${year}`;
        }

        document.getElementById('hora-atual').textContent = `${hours}:${minutes}`;
    }

    function updateProfessionalTitle() {
        const select = document.getElementById('profissional');
        // Remove a classe 'required' quando um profissional é selecionado
        if (select.value) {
            select.classList.remove('required');
        }
    }

    function formatCPF(cpf) {
        cpf = cpf.replace(/\D/g, ''); // Remove tudo que não é dígito
        if (cpf.length > 11) {
            cpf = cpf.substring(0, 11);
        }
        cpf = cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        return cpf;
    }

    function capitalizeName(name) {
        if (!name) return ""; // Evita erros com nomes vazios

        const words = name.toLowerCase().split(' ');
        const exceptions = ["da", "das", "de", "do", "dos", "e"]; // Palavras a serem ignoradas

        const capitalizedWords = words.map((word, index) => {
            if (exceptions.includes(word) && index !== 0) {
                return word; // Mantém minúscula se for exceção e não for a primeira palavra
            }
            return word.charAt(0).toUpperCase() + word.slice(1); // Primeira letra maiúscula
        });

        return capitalizedWords.join(' ');
    }

    function autoFillName(name) {
        const commonNames = {
            "maria": "Maria Silva",
            "joao": "João Silva",
            "jose": "José Santos",
            "ana": "Ana Souza"
        };

        const lowerCaseName = name.toLowerCase();
        if (commonNames[lowerCaseName]) {
            return commonNames[lowerCaseName];
        }
        return name;
    }

    function generateAndPrint() {
        const nomeField = document.getElementById('nome');
        let nomeValue = nomeField.textContent.trim();
        const profissional = document.getElementById('profissional').value;
        const profissionalSelect = document.getElementById('profissional');
        const cpfField = document.getElementById('cpf');
        let cpfValue = cpfField.textContent.trim();

        if (!nomeValue) {
            showMessage("Por favor, preencha pelo menos o nome do paciente antes de imprimir.", false);
            return;
        }

        if (!profissional) {
            showMessage("Por favor, selecione o profissional antes de imprimir.", false);
            profissionalSelect.classList.add('required');
            return;
        }

        // Auto-fill and capitalize name
        nomeValue = autoFillName(nomeValue);
        nomeValue = capitalizeName(nomeValue);

        let formattedCPF = formatCPF(cpfValue);
        nomeField.textContent = nomeValue; // Update the name field with capitalized name
        cpfField.dataset.originalValue = cpfValue;
        cpfField.textContent = formattedCPF;

        updateDateTime();
        document.querySelectorAll('[contenteditable]').forEach(function(field) {
            field.removeAttribute('contenteditable');
        });

        window.print();

        document.querySelectorAll('.value').forEach(function(field) {
            if (field.id !== 'hora-atual' && field.id !== 'data-atual') {
                field.setAttribute('contenteditable', 'true');
            }
        });

        showMessage(
            "Declaração impressa com sucesso! Seu trabalho dedicado faz a diferença aqui na UBS! Sorria, pois seu esforço é essencial para todos nós 😊",
            true);
    }

    function resetForm() {
        document.getElementById('nome').textContent = "";
        const cpfField = document.getElementById('cpf');
        cpfField.textContent = "";
        cpfField.dataset.originalValue = "";

        // Reset com a data atual
        const today = new Date();
        const day = String(today.getDate()).padStart(2, '0');
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const year = today.getFullYear();
        document.getElementById('data').textContent = `${day}/${month}/${year}`;

        document.getElementById('horario').textContent = "das 00:00 às 00:00 (período da manhã)";

        document.querySelectorAll('input[type="checkbox"]').forEach(function(checkbox) {
            checkbox.checked = false;
        });

        const profissionalSelect = document.getElementById('profissional');
        profissionalSelect.value = "";
        profissionalSelect.classList.remove('required');

        showMessage("Formulário limpo com sucesso!", true);
    }

    function showMessage(text, isSuccess) {
        const messageElement = document.getElementById('message');
        messageElement.textContent = text;
        messageElement.style.display = 'block';

        if (isSuccess) {
            messageElement.className = 'message success';
        } else {
            messageElement.className = 'message';
            messageElement.style.backgroundColor = '#f8d7da';
            messageElement.style.color = '#721c24';
            messageElement.style.border = '1px solid #f5c6cb';
        }

        setTimeout(function() {
            messageElement.style.display = 'none';
        }, 5000);
    }

    window.addEventListener('afterprint', function() {
        showMessage("Declaração impressa com sucesso! Obrigado pelo seu trabalho dedicado.", true);
        const cpfField = document.getElementById('cpf');
        cpfField.textContent = cpfField.dataset.originalValue; // Restore the raw value

        const nomeField = document.getElementById('nome');
        nomeField.setAttribute('contenteditable', 'true');

        cpfField.setAttribute('contenteditable', 'true');
    });

    document.addEventListener('DOMContentLoaded', function() {
        updateDateTime();
        setInterval(updateDateTime, 60000);

        // Formatar os campos editáveis
        document.querySelectorAll('[contenteditable]').forEach(function(field) {
            field.addEventListener('focus', function() {
                this.style.backgroundColor = '#f8f9fa';
            });
            field.addEventListener('blur', function() {
                this.style.backgroundColor = '';
            });
        });

        const nomeField = document.getElementById('nome');

        nomeField.addEventListener('blur', function() {

            let nomeValue = nomeField.textContent.trim();

            nomeValue = autoFillName(nomeValue);

            nomeValue = capitalizeName(nomeValue);

            nomeField.textContent = nomeValue; // Update the name field with capitalized name

        });

        // Formatar CPF automatically
        const cpfField = document.getElementById('cpf');

        cpfField.addEventListener('input', function() {
            let value = this.textContent.replace(/\D/g, ''); // Remove não dígitos
            if (value.length > 11) {
                value = value.substring(0, 11); // Limita a 11 dígitos
            }
            this.textContent = value; // Update the displayed text with digits only
            this.dataset.originalValue = value; // Store the original value without formatting
        });
    });
    </script>
</body>

</html>
